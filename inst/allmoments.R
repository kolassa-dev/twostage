u1<-function(m,n){m*n/2}
u2<-function(m,n){1/2*m*n+1/4*m*n*(m-1)*(n-1)+1/3*m*n*(m-1)+1/3*m*n*(n-1)}
u3<-function(m,n){ 3*u2(m,n)*m*n/2-m^3*n^3/4}
u4=function(m,n){
  (m^4*n^4)/16 + (m^4*n^3)/8 + (m^4*n^2)/48 - (m^4*n)/120 + (m^3*n^4)/8 +
    (m^3*n^3)/6 + (m^3*n^2)/40 - (m^3*n)/60 + (m^2*n^4)/48 + (m^2*n^3)/40 - 
    (m^2*n^2)/240 - (m^2*n)/120 - (m*n^4)/120 - (m*n^3)/60 - (m*n^2)/120}

u1u2<-function(m,n,M,N){
  u2(m,n)*(1+(M-m)/(m+n+1)+(N-n)/(m+n+1))+
    m*n/2*((M-m)*n*(n+1)/(m+n+1)+(N-n)*m*(m+1)/(m+n+1)+(M-m)*(N-n))/2}

u12u2<-function(m,n,M,N){u3(m,n)*(1+(M-m)/(m+n+1)+(N-n)/(m+n+1))+
    u2(m,n)*((M-m)*n*(n+1)/(m+n+1)+(N-n)*m*(m+1)/(m+n+1)+(M-m)*(N-n))/2}

u1u22<-function(m,n,M,N){u3(M,N)*(m*n/M/N)}

u13u2<-function(m,n,M,N){u4(m,n)*(1+(M-m)/(m+n+1)+(N-n)/(m+n+1))+
  u3(m,n)*((M-m)*n*(n+1)/(m+n+1)+(N-n)*m*(m+1)/(m+n+1)+(M-m)*(N-n))/2}

u1u23<-function(m,n,M,N){u4(M,N)*(m*n/M/N)}

u12u22<-function(m,n,M,N){(m*n/M/N-m*(m-1)*n*(n-1)/M/N/(M-1)/(N-1))*u3(M,N)+
    (m*n*(n-1)/M/N/(N-1)-m*n*(m-1)*(n-1)/M/N/(M-1)/(N-1))*(N*M*(N-1)*
  (1/3*(N-2)*(M-1)*(1/2+(N-3)/3+(M-2)/3+(N-3)*(M-2)/4)+2*(N-2)/4*(N-3)*(M-1)/2+
 2*(N-2)*(M-1)*3/20+4*(M-1)*5/24*(N-2)*(M-2)/2+4*(M-1)*(N-2)*2/15+
 4/3*(N-2)*(M-1)/2+(N-2)/4+(N-2)*(N-3)/5+2*(M-1)*(5/24+1/6)+
 2*(M-1)*(M-2)*(3/20+2/15)+4/3+4*(N-2)/4+8*(M-1)*5/24+4*(N-2)*(M-1)*3/20))+
 (m*n*(m-1)/M/N/(M-1)-m*(m-1)*n*(n-1)/M/N/(M-1)/(N-1))*M*N*(M-1)*
(1/3*(M-2)*(N-1)*(1/2+(M-3)/3+(N-2)/3+(M-3)*(N-2)/4)+
 2*(M-2)/4*(M-3)*(N-1)/2+ 2*(M-2)*(N-1)*3/20+4*(N-1)*5/24*(M-2)*(N-2)/2+  
  4*(N-1)*(M-2)*2/15+4/3*(M-2)*(N-1)/2+ (M-2)/4+(M-2)*(M-3)/5+
2*(N-1)*(5/24+1/6)+2*(N-1)*(N-2)*(3/20+2/15)+4/3+4*(M-2)/4+8*(N-1)*5/24
+4*(M-2)*(N-1)*3/20)+m*(m-1)*n*(n-1)/M/N/(M-1)/(N-1)*u4(M,N)}

k1<-function(m,n,M,N){u1(m,n)+u1(M,N)}

k2<-function(m,n,M,N){-u1(M,N)^2 + u2(M,N)-(u1(M,N)*u1(m,n)) + u1u2(m,n,M,N)-
    u1(m,n)^2 + u2(m,n)}

k3<-function(m,n,M,N){
  2*u1(M,N)^3-3*u1(M,N)*u2(M,N)+u3(M,N)+2*u1(m,n)*u1(M,N)^2-u2(M,N)*u1(m,n)-
    2*u1(M,N)*u1u2(m,n,M,N)+u1u22(m,n,M,N)+2*u1(M,N)*u1(m,n)^2-
    2*u1(m,n)*u1u2(m,n,M,N)-u1(M,N)*u2(m,n)+u12u2(m,n,M,N)+
    2*u1(m,n)^3-3*u1(m,n)*u2(m,n)+u3(m,n)}

k4<-function(m,n,M,N){
  -6*u1(M,N)^4+12*u1(M,N)^2*u2(M,N)-3*u2(M,N)^2-4*u1(M,N)*u3(M,N)+u4(M,N)-
    6*u1(M,N)^3*u1(m,n)+6*u1(M,N)*u2(M,N)*u1(m,n)-u3(M,N)*u1(m,n)+
    6*u1(M,N)^2*u1u2(m,n,M,N)-3*u2(M,N)*u1u2(m,n,M,N)-3*u1(M,N)*u1u22(m,n,M,N)+
    u1u23(m,n,M,N)-6*u1(M,N)^2*u1(m,n)^2+2*u2(M,N)*u1(m,n)^2+
    8*u1(M,N)*u1(m,n)*u1u2(m,n,M,N)-2*u1u2(m,n,M,N)^2-2*u1(m,n)*u1u22(m,n,M,N)+
    2*u1(M,N)^2*u2(M,N)-u2(m,n)*u2(M,N)-2*u1(M,N)*u12u2(m,n,M,N)+u12u22(m,n,M,N)-
    6*u1(M,N)*u1(m,n)^3+6*u1(m,n)^2*u1u2(m,n,M,N)+6*u1(M,N)*u1(m,n)*u2(m,n)-
    3*u1u2(m,n,M,N)*u2(m,n)-3*u1(m,n)*u12u2(m,n,M,N)-u1(M,N)*u3(m,n)+u13u2(m,n,M,N)-
    6*u1(m,n)^4+12*u1(m,n)^2*u2(m,n)-3*u2(m,n)^2-4*u1(m,n)*u3(m,n)+u4(m,n)
  
}
